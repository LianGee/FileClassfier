肌电感应的运动分析
 东华大学计算机科学与技术学院, 李锋
东华大学计算机科学与技术学院, 陈波

【摘要】 表面肌电信号是皮下肌肉活动在皮肤表面处便显出微弱的电压信号，它反映了人体运动时肌肉动作的时间和空间信息。对于不同的运动动作，人体各个肌肉群产生的肌电信号的强度也各有差异。本文设计了一种可穿戴的肌电信号强度评级设备。通过提取采集到的多路肌电信号的时域、频域特征值，用加权归一化的方法给信号强度评级，从而确定人体运动时指定肌肉群的运动强度。有利于设计目的性较强的运动动作。

【关键词】表面肌电信号；特征值；可穿戴设备；运动强度 
中图法分类号 TP183

 
1  	引言
 
肌电信号是皮下肌肉活动在皮肤表面处表现出微弱电压信号，它反映了人体运动时肌肉动作的时间和空间信息[1]随着神经肌肉电信号模式识别方面研究的日益深入和肌电检测技术的不断提高。肌电感应的运动分析不仅是基础研究的需要，而且有着重要的实际应用价值。目前表面肌电信号已经被广泛的应用于肌肉运动、康复医学、肌肉损伤诊断以及体育等方面的研究。
国内外许多研究都表明通过对肌电信号进行分析能够发掘出人体肌肉的在做不同动作时的运动强度等信息[2~4]。
本文设计了一套肌电感应系统对肌电信号的进行处理和分析。通过肌电感应，确定哪块肌肉运动量大，从而判定不同运动，对哪些肌肉群锻炼效果更好，用来设计运动锻炼的动作。
2  	系统总体设计
该系统分为两个部分：肌电采集模块和控制中心如图1。其中几点采集模块主要完成肌电信号感知，模块控制中心和无线通讯模块，系统电源由小型锂电池提供。
 图1系统结构图
由于该系统为直接接触人体的健康类消费产业，本系统不提供交流介入和充电功能。另为了接触的可靠性，以及肌肉群的测试，本系统的采集电极由多个肌电采集电极组装成采集束带如图2。每个束带有8个采集点。控制模块和通讯模块，设计在束带背面。可直接佩戴在肢体上，方便操作（图3）。
 
图2肌电束带示意图
 
图3系统装置设计图
在本系统中信号分析和控制中心主要负责收集多路肌电信号，完成肌电信号初步分析，以及结果展示。无线通讯模块：主要负责肌电采集模块和控制中心的无线通讯。
2.1  	肌电感知模块
肌电感知模块主要是通过肌电采集电极，采集个体运动时产生的肌电信号，完成信号的滤波、放大和模数转换。
1)	放大滤波电路
肌电信号的电压范围在和之间，频率为，主要能量分布于内。由于信号容易形成运动的伪迹，且主要集中在频率范围内[]。针对肌电信号的特点，我们设计了相应的滤波放大电路（图4）。系统采用AD8220和OPA364两个高输入阻抗、高CMRR、低电流噪声的放大芯片，信号以差分方式输入，两个运算放大器与外围元件形成了一个共1k倍、20~1000 Hz 的两级带通滤波放大器。前级运放为AD8220，它的电流噪声仅1fA/Hz，芯片占用电路板面积小，适应于可穿戴设备。放大电阻为1.5k，电容为10的电容，放大倍数为32倍。
后级运放OPA364,SOT23-5封装,适合于传感器的微型化设计，为一个频带为20-1kHz切比雪夫Ⅰ型的1阶带通滤波器,放大倍数约30倍。
 
图4滤波放大电路
2)	数模转换电路
LTC1867L 是个8 通道12位/16位A/D转换器，芯片具有串行I/O通道，采用内部电压基准。LTC1867L 的 DC 性能出众，在整个温度范围内具有 ±3LSB INL 规格和 16 位无漏失码。通过对芯片8通道输入多路复用器的配置，芯片可工作于单端或差分输入，单极或双极转换操作(或其组合)。ADC 负责转换 0V 至 2.5V 单极输入或 ±1.25V 双极输入。在本方案中，其工作于双极差分输入状态。
LTC1867L仅吸收 750μA 电流。有自动打盹和睡眠模式，有利于那些对功耗敏感的应用。 LTC1867L 采用紧凑型、窄体 16 引脚 SSOP 封装，适用于空间敏感以及低功率的应用。
2.2  	通讯模块
通讯模块采用蓝牙通讯协议，用以完成肌电束带和控制中心（手机）的通讯，向中心汇报束带各点电位信号，并接受中心的控制命令，如是否产生刺激信号，信号强度等级等。其中蓝牙版本采用4.0BLE。
1.	支持蓝牙4.0低功耗主从模式。
2.	支持点对点，点对多模式。
3.	支持固件在线升级。
4.	内置天线距离可达50米。
5.	自动节能模式，支持低功耗模式。
6.	符合FCC，CE，ROSH等认证。
7.	支持用户设定波特率(1200-115200)，设备名称，主从，节能参数等多种参数。
8.	有RSSI输出和载波帧听。
9.	模块内置了协议：
LL：控制射频的信号。
SMP：管理加密秘钥和身份秘钥的存储。
L2CAP：将基带层数据分组交换以便高层应用数据分组格式。
ATT：实现了属性客户端和服务端之间的点对点协议。
GATT：BLE通信如何中断建立连接通信，具体有16中规范。
GAP：该Profile保证不同的Bluetooth产品可以互相发现对方并建立连接。
10.	另外低功耗4.0蓝牙模块还可以定制添加：SPP、HID、OPP、HDP、CTP、GOEP、 HSAGP、BIP、BIR、PPP、BPP、UPD、LMP、ICP、MAP、CTP、DID、MAP、GOEP、L2CAP、RFCOMM、SDP、GAP、GATT、ATT、SMP 等多种蓝牙profile。
11.	支持微信AIRSYNC协议，支持苹果ANCS协议。
12.	多路PI/O输入输出直接控制：支持多路遥控。
13.	4路PWM控制：支持调光，调速
14.	ADC模拟量输入输出：直接输入模拟传感器，不用外接ADC。
蓝牙模块技术指标如表1：
表1 蓝牙模块技术指标
工作频率	ISM频段 2.400～2.483MHz
蓝牙规范	V4.0BLE
扩频方式	FHSS
电压	2.7-3.6V
发射功率	+4.5dBm
传输距离	10-50米
接收灵敏度	<-88dBm at < 0.1% BER
工作温度	-20℃-+75℃
存储温度	-40℃-85℃
连接蓝牙待机电流	0.2MA左右
天线规格	2.4G 50欧姆
安全认证	AES 128位
尺寸	14*22mm

2.3  	控制中心
控制中心接收蓝牙模块发送过来的由采集模块采集到的多路肌电信号，并对这些信号进行强度评级。本文采取的评级方法是通过提取肌电信号的平均值、积分均值、功率谱比值，进行加权运算。
对于时域特征值平均值和积分均值计算方法如下：
平均值计算公式如式1，它是用来衡量数据集中趋势的一种方法。本文选取平均值作为衡量肌电信号的平稳趋势。
   (1)
若对离散的数字信号数据直接求均值AVE，很多时候都会趋近于0，这不能很好地表征信号之间的差异，因此再提取积分均值作为判定肌肉运动强度的另一个特征。
 (2)
对于频域特征一般采用功率谱进行度量，但由于肌电信号功率谱的分布相对比较稳定，所以在信号最大值附近的功率谱的能量在整体信号中的比重也比较稳定，且不受最大值具体出现位置的影响。因此，采用频域分析法中的功率谱比值法【】进行特征提取。
设功率谱比值为K，其计算公式如式3：
 (3)
式中，K为功率谱比值，P(f)为功率谱。根据文献【】中的经验得知取15Hz的特征值有较好的区分度，为功率谱在Hz的面积。P为整个功率谱的面积，由于肌电信号的频率主要集中在50~500Hz,所以求P的积分区间为50~500Hz。为功率谱最大值处的频率，即的解，如果有多个解，则取使得功率谱值最大的解。
于是每一路信号的平均值AVE、积分均值MAV并求解功率谱比值K。再根据式4计算第i路加权强度：
       (4)
其中(n表示通道数)暂取，，。再对进行归一化，给出评级系数（式5）：
              (5)
越大表示该通道所对应的肌肉运动强度越大。对于某一个训练动作，给出相应的肌肉评价，可以判定该动作更适合增强哪块肌肉的训练。通过肌电信号强度评级有助于我们设计更合理的训练动作，达到训练某块肌肉的目的。
3  	结论
本文设计了一套多路肌电信号采集与分析系统。对一个训练动作，进行了多个肌肉群的表面肌电信号采集，并通过提取表面肌电信号的时域、频域特征值，进行加权归一化等计算，分析了该动作对应肌肉群的运动强度。有助于设计更具目的性的运动动作，具有很强的现实意义。
本实验中加权系数的取值，在个别个体上取得了较好的实验效果。但推广到一般，还需要搜集更多的样本数据进行统计分析。





参考文献
 [20] Hua Y, Jie Y. A direct LDA algorithm for high-dimensional data-with application to face recognition. Pattern Recognition, 2001, 34(10):2067-2070.




